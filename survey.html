<!DOCTYPE html>
<html lang="fa" dir="rtl" class="rtl ng-scope">
<head>
  <title>Billboard</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    var i=-1;
    function add_more(addbtn){
      i++;
      var choices=0;
      var question_label=document.createElement('label');
      question_label.setAttribute('for',i);
      question_label.setAttribute('class',i);
      question_label.setAttribute('id','label' + i);
      var labelVal=i+1;
      question_label.innerHTML="سوال"+labelVal;
      var question_div=document.createElement('div');
      question_div.setAttribute("id" , i );
      question_div.setAttribute("class" , "q" ,'col-sm-8');
      var delQuestion=document.createElement('button');
      delQuestion.setAttribute("type", "button");
      delQuestion.setAttribute("class", i);
      delQuestion.setAttribute("id", "deleteQuestion" + i);
      delQuestion.setAttribute('onclick','delete_question(this)');
      var delSpan=document.createElement('span');
      delSpan.setAttribute('class','glyphicon glyphicon-remove');
      delSpan.style.color="red";
      delQuestion.appendChild(delSpan);
      var question=document.createElement('input');
      question.setAttribute("type", "text");
      question.setAttribute  ("name","q"+i);
      question.setAttribute("class", "question");
      question.setAttribute("id", "question" + i);
      var br=document.createElement('br');
      var addChoice=document.createElement('button');
      addChoice.setAttribute("type", "button");
      addChoice.setAttribute("onclick","add_choice(this)");
      //addChoice.setAttribute("value","افزودن گزینه");
      addChoice.setAttribute("id","addChoice"+ i);
      addChoice.setAttribute("class", i);
      var addSpan=document.createElement('span');
      addSpan.setAttribute('class','glyphicon glyphicon-plus');
      addChoice.appendChild(addSpan);
      document.getElementById('questions').appendChild(question_label);
      document.getElementById('questions').appendChild(question_div);
      document.getElementById(i).appendChild(question);
      document.getElementById(i).appendChild(delQuestion);
      document.getElementById(i).appendChild(br);
      document.getElementById(i).appendChild(addChoice);
      document.getElementById('questions_count').setAttribute('value',i+1);
    }

    function add_choice(btn){
      var choices=document.getElementById(btn.className).getElementsByTagName('input').length-1;
      alert(choices)
      var choice=document.createElement('input');
      choice.setAttribute("type", "text");
      choice.setAttribute("name", "item"+ btn.className);
      choice.setAttribute('class','choice');
      choice.setAttribute('id',choices + 'choice'+btn.className);
      var br=document.createElement('br');
      var delBtn=document.createElement('button');
      //alert(document.getElementById(btn.className).getElementsByClassName("choice").length);
      delBtn.setAttribute('onclick','delete_item(this)');
      delBtn.setAttribute('name','delete'+ btn.className );
      delBtn.setAttribute('id',choices+'deleteItem'+btn.className);
      delBtn.setAttribute('class',btn.className);
      var delSpan=document.createElement('span');
      delSpan.setAttribute('class','glyphicon glyphicon-remove');
      delSpan.style.color="red";
      delBtn.appendChild(delSpan);
      document.getElementById(btn.className).insertBefore(choice,btn);
      document.getElementById(btn.className).insertBefore(delBtn,choice.nextSibling);
      document.getElementById(btn.className).insertBefore(br,btn);

    }
    function delete_item(btn){
      var deletingElement=btn.previousSibling;
      var thisId=btn.id;
      var start=thisId.slice(0, thisId.indexOf('deleteItem'));
      var idName=btn.parentNode.id;
      var thisClass=btn.className;
      var choices=btn.parentNode.getElementsByTagName('input').length-1;
      document.getElementById(idName).removeChild(deletingElement);
      document.getElementById(idName).removeChild(btn.nextSibling);
      document.getElementById(idName).removeChild(btn);
      for (var a = parseInt(start)+1; a <choices; a++) {
        var pre=a-1;
        document.getElementById(a +'choice'+thisClass).setAttribute('id',pre +'choice'+thisClass)
        document.getElementById(a +'deleteItem'+thisClass).setAttribute('id',pre +'deleteItem'+thisClass)
      }
    }
    function delete_question(btn){
      var deletingDiv=btn.parentNode;
      var index=parseInt(btn.className)+1;
      document.getElementById('questions').removeChild(deletingDiv.previousSibling);
      document.getElementById('questions').removeChild(deletingDiv);
      for(var a=index;a<=i;a++){
        var pre=a-1;
        var choices=document.getElementById(a).getElementsByTagName('input').length-1;

        for(var b=0;b<choices;b++){
          document.getElementById(b+"choice"+a).setAttribute("name", "item"+ pre);
          document.getElementById(b+"choice"+a).setAttribute("id", b +"choice"+ pre);
          document.getElementById(b+'deleteItem'+a).setAttribute("id", b +"deleteItem"+ pre);
          document.getElementById(b+'deleteItem'+pre).setAttribute("name",'delete'+ pre );
        }
        document.getElementById(a).setAttribute('id',pre);
        document.getElementById("label"+a).innerText="سوال"+ a;
        document.getElementById("label"+a).setAttribute('id',"label"+pre);
        document.getElementById("label"+pre).setAttribute('for',pre);
        document.getElementById("question"+a).setAttribute('name',"q"+pre);
        document.getElementById("question"+a).setAttribute('id',"question"+pre);
        document.getElementById("addChoice"+a).setAttribute('class', pre);
        document.getElementById("addChoice"+a).setAttribute('id',"addChoice"+ pre);
        document.getElementById("deleteQuestion"+a).setAttribute('class', pre);
        document.getElementById("deleteQuestion"+a).setAttribute('id',"deleteQuestion"+ pre);

      }
      i--;
    }
    function getInputsByValue(value)
    {
      var allInputs = document.getElementsByTagName("input");
      var results = [];
      for(var x=0;x<allInputs.length;x++)
          if(allInputs[x].value == value)
              results.push(allInputs[x]);
      return results;
    }
  function insertAfter(newNode, referenceNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
  }
  </script>

  <style>
    body{
    direction: rtl;
    background: linear-gradient(to bottom,rgb(201, 200, 189),rgb(232, 229, 201));
    }
    .navbar {
      direction: rtl;
      margin-bottom: 50px;
      border-radius: 0;
    }
    /* Add a gray background color and some padding to the footer */
    .row.content {height: 450px}

/* Set gray background color and 100% height */
    .sidenav {
        padding-top: 20px;
        height: 100%;
      }

    @media (min-width: 768px) {
      .navbar-nav>li {
        float: right
      }
    }
    .dropdown-menu{
      background-color:rgb(181, 175, 175) ;
      text-align: right;
    }
    .choice{
      width: 70%;
      margin-right: 5%;
    }
    .logo {
      width: 50px;
      height: 50px;
      overflow: hidden;
    }
    .questionnaire{

      background-image: url('questionForm.png');
      height: 600px;
      overflow: scroll;
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      direction: rtl;
    }
    .form-group{
      direction: rtl;
    }
    .q{
      border-style: dashed;
      background-color: rgba(165, 182, 183,0.5);
    }
    .question{
      width: 90%;
    }
    #deleteQuestion{
      margin: 0px;
    }
    #logo{
      width:50px;
      height: 50px;
    }
    .sidenav{

    }
    .glyphicon-plus{
      color: green;
    }
  </style>
</head>
<body>


<nav class=" navbar navbar-inverse sticky-top fixed-top text-r " dir="rtl">
  <div class="container-fluid ">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand dropdown-toggle text-right" data-toggle="dropdown" id="profile-nav" dir="rtl" href="#">پروفایل <span class="glyphicon glyphicon-user"></span><span class="caret"></span></a>
        <ul class=" dropdown-menu text-right" dir="rtl" >
          <li><a href="#"><span class="glyphicon glyphicon-user"></span> مشخصات کاربری </a></li>
          <li><a href="#"><span class="glyphicon glyphicon-stats"></span> فعالیت های من</a></li>
          <li><a href="#"><span class="glyphicon glyphicon-log-out"></span> خروج </a></li>
        </ul>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <a class="logo hidden-xs hidden-sm navbar-right" href="#"><img id="logo" src="logo.png"/> </a>
      <ul class="nav navbar-nav navbar-right " dir="rtl">
        <li ><a href="#">خانه</a></li>
        <li class="active"><a href="#">ایجاد پرسشنامه</a></li>
        <li><a href="#">افزودن اپلیکیشن</a></li>
      </ul>

    </div>
  </div>
</nav>
<div class="container-fluid ">
  <div class="row content">
    <div class="col-sm-2 sidenav hidden-sm hidden-xs ">
    </div>
    <div class="questionnaire col-sm-8 ">
        <form id="questionnaire" dir="rtl">
          <label for="question_name" dir="rtl"> نام پرسشنامه خود را وارد کنید </label><br>
          <input type="text"  id="question_name" name="question_name"><br><br>
          <input type="hidden" id="questions_count" name="questions_count"/>
          <div id="questions" class='questions'>
          </div>
          <button id="add_question" class="btn add-more" type="button" onclick="add_more(this)"><span class="glyphicon glyphicon-plus"></span></button><br/>
          <button type="submit" class="btn btn-default">ثبت نهایی</button>
        </form>
    </div>
    <div class="col-sm-2 sidenav ">
    </div>
  </div>
</div><br>
</body>
</html>
